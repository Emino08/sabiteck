# SABI Backend Root Directory .htaccess
# Place this file in the backend root directory
# Provides additional security for the backend directory

# Deny access to the entire backend directory except public folder
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Redirect all requests to the public directory
    RewriteCond %{REQUEST_URI} !^/public/
    RewriteRule ^(.*)$ public/$1 [L]
</IfModule>

# Security: Block access to sensitive files and directories
<FilesMatch "(^#.*#|\.(bak|conf|dist|fla|inc|ini|log|orig|psd|sh|sql|sw[op])|~)$">
    Order allow,deny
    Deny from all
    Satisfy All
</FilesMatch>

# Block access to specific directories
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Block access to vendor, config, src directories
    RewriteRule ^(vendor|config|src|migrations|storage|tests)/.*$ - [F,L]
    
    # Block access to composer files
    RewriteRule ^composer\.(json|lock)$ - [F,L]
    
    # Block access to environment files
    RewriteRule ^\.env.*$ - [F,L]
</IfModule>

# Additional security headers
<IfModule mod_headers.c>
    Header always set X-Frame-Options "DENY"
    Header always set X-Content-Type-Options "nosniff"
    Header unset Server
    Header unset X-Powered-By
</IfModule>

# Disable directory browsing
Options -Indexes

# Disable server signature
ServerSignature Off